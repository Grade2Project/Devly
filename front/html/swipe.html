<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../all.css">
    <link rel="stylesheet" href="../styleguide.css">
    <link rel="stylesheet" href="../sellect.css">
    <link rel="stylesheet" href="settings/side-menu.css">

    <style>
        body {
            background: var(--color-background);
            font-family: var(--font-family-roboto);
        }
    </style>
</head>
<body>
<template id="template__user_card">
        <div class="center-cropped">
            <img src="" alt="Image Here" id="user_photo">
        </div>
        <div class="information__holder">
            <div class="inner__holder">
                <span class="label__28B_600" id="user_name"></span>
                <span class="label__18B_500_GREY" id="user_city"></span>
            </div>
            <div class="inner__holder">
                <span class="label__18B_500_GREY" id="user_languages"></span>
                <span class="label__18B_500_GREY" id="user_grade"></span>
            </div>
        </div>
        <div class="extra-info__button"></div>
        <div class="extra__base__container">
            <div class="extra__inner__container">
                <span class="label__20B_600">Рабочие условия</span>
                <div class="__data__container">
                    <span class="label__16B_500" id="user_position"></span>
                    <span class="label__16B_500" id="user_experience"></span>
                    <span class="label__16B_500" id="user_salary"></span>
                    <span class="label__16B_500" id="user_schedule"></span>
                </div>
            </div>

            <div class="extra__inner__container">
                <span class="label__20B_600">Образование</span>
                <div class="__data__container">
                    <span class="label__16B_500" id="user_edu_grad"></span>
                    <span class="label__16B_500" id="user_edu_name"></span>
                    <span class="label__16B_500" id="user_edu_program"></span>
                    <span class="label__16B_500" id="user_edu_release"></span>
                </div>
            </div>

            <div class="extra__inner__container">
                <span class="label__20B_600">О себе</span>
                <div class="__data__container">
                    <span class="label__16B_500" id="user_ext_info"></span>
                </div>
            </div>
        </div>
</template>

<template id="template__vacancy_card">
    <div class="center-cropped">
        <img src="" alt="Image Here" id="company_photo">
    </div>
    <div class="information__holder">
        <div class="inner__holder">
            <span class="label__28B_600" id="company_name"></span>
            <span class="label__18B_500_GREY" id="vacancy_city"></span>
        </div>
        <div class="inner__holder">
            <span class="label__18B_500_GREY" id="vacancy_language"></span>
            <span class="label__18B_500_GREY" id="vacancy_grade"></span>
        </div>
    </div>
    <div class="extra-info__button"></div>
    <div class="extra__base__container">
        <div class="extra__inner__container">
            <span class="label__20B_600">Вакансия</span>
            <div class="__data__container">
                <span class="label__16B_500" id="vacancy_position"></span>
                <span class="label__16B_500" id="vacancy_salary"></span>
            </div>
        </div>

        <div class="extra__inner__container">
            <span class="label__20B_600">О нас</span>
            <div class="__data__container">
                <span class="label__16B_500" id="vacancy_ext_info"></span>
            </div>
        </div>
    </div>
</template>

    <div class="left__menu__container">
        <div class="left__menu__header__container">
            <img id="image" class="profile__image" src="">
            <span id="name" class="label__20B_600">Оля Контур</span>
        </div>
        <div class="content__container">
            <div>
                <label for="grades__filter">Грейд</label><input type="text" id="grades__filter">
            </div>

            <div>
                <label for="languages__filter">Языки программирования</label><input type="text" id="languages__filter">
            </div>

            <div>
                <label for="cities__filter">Города</label><input type="text" id="cities__filter">
            </div>

            <button class="button__confirm color-green" id="apply_filters" type="button">
                <span class="button__confirm_inner">Применить</span>
            </button>
        </div>
    </div>
    <div class="swipe__cards">
        <div class="tinder">
            <div class="tinder__status">
                <i class="fa fa-remove"></i>
                <i class="fa fa-heart"></i>
            </div>

            <div class="tinder__cards">

            </div>

            <div class="tinder--buttons">
                <button id="nope"><i class="fa fa-remove"></i></button>
                <button id="love"><i class="fa fa-heart"></i></button>
            </div>
        </div>
    </div>

<script src="../scripts/hammer.js"></script>
<script src="../scripts/utils.js"></script>
<script src="../scripts/createCard.js"></script>
<script src="../scripts/swipes.js"></script>
<script src="../scripts/sideMenu.js"></script>
<script src="../scripts/sellect.js-master/src/sellect.js"></script>
<script>
    let token = localStorage.getItem('token');

    fillSideMenu(
        localStorage['way'] === 'user' ? Controllers.ABOUTME.USER : Controllers.ABOUTME.COMPANY,
        function () {},
    )

    fetchFrom(Controllers.GRADES, (statusCode, response) => {
        if (statusCode === 401)
            location.href = '../html/authorization.html';

        let grades = response.container;
        let gradesFilter = sellect(document.getElementById('grades__filter'), {
            originList: grades
        });

        gradesFilter.init();
    }, localStorage['token']); //  ToDo: В отдельную функцию

    fetchFrom(Controllers.LANGS, (statusCode, response) => {
        let langs = response.container;
        let langsFilter = sellect(document.getElementById('languages__filter'), {
            originList: langs
        });

        langsFilter.init();
    }, localStorage['token']);

    let citiesFilterE = document.getElementById('cities__filter');
    let mockParent = document.createElement('div');
    let mock = document.createElement('input');
    mock.setAttribute('type', 'text');
    mock.setAttribute('id', 'cities__filter');
    mockParent.appendChild(mock);

    let citiesFilter = sellect(citiesFilterE, {
        originList: []
    });
    citiesFilter.init();

    citiesFilterE.oninput = () => {
        fetchFrom(`${Controllers.CITIES}?pattern=${citiesFilterE.value}`, (statusCode, response) => {
            citiesFilter.refresh(response.container);
        });
    }

    const cardHandler = localStorage['way'] === 'user'
        ? new CardCreator(new VacancyCardHandler())
        : new CardCreator(new UserCardHandler());

    cardHandler.appendCardToDoc();

</script>
</body>
</html>
